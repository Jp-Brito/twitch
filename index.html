<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lives ON</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body onLoad="carrego()">
  <button id="att" onclick="atualizarLives()">Atualizar</button>
  <div class="livesprofile" id="livesprofile"></div>

  <div id="twitch-embed"></div>

  <script src="https://embed.twitch.tv/embed/v1.js"></script>

  <script type="text/javascript">
    const lives = [
      ['jonvlogs', '00e7ebf9-89b9-41e1-b2bc-263b0ce805d0'],
      ['diegogelio_', '2211765a-e752-4812-9b53-84af4b9f9d31'],
      ['tiliaoficial', '236567d4-b236-47e6-aa2f-81e2d0af76c3'],
      ['maumauzk_ofc', '829be78d-edcf-4c69-a30a-d6d73003744f'],
      ['cabritoz', 'e536cf88-fc55-4438-941b-b228ab82166d'],
      ['MeikodRJ', '9581207b-7255-4616-bfd0-4471a2e9de9e']
    ];
    const tamanholist = lives.length

    const livescontainer = document.getElementById("livesprofile");
    function createLives() {
      lives.forEach((item, index) => {

        var liveEmbed = new Twitch.Embed("twitch-embed", {
          channel: item[0],
          autoplay: false,
          layout: 'video'
        });
        lives.push(liveEmbed)

        const ancora = document.createElement('a')
        ancora.href = `https://www.twitch.tv/${item[0]}`;
        ancora.target = '_blank'
        livescontainer.appendChild(ancora);

        const img = document.createElement("img");
        img.classList.add('profile')
        img.setAttribute('id', item[0])
        img.setAttribute('src', `https://static-cdn.jtvnw.net/jtv_user_pictures/${item[1]}-profile_image-70x70.png`);
        ancora.appendChild(img);
      })
    }

    function atualizarLives() {
      const imgs = document.querySelectorAll('img')
      imgs.forEach((item, index) => {
        let idlive = lives[index + tamanholist]._player._playerState.duration
        if (idlive === 0) {
          item.style.borderColor = '#ff0000'
        } else {
          item.style.borderColor = '#00ff00'
        }
      })
    }

    function carrego() {
      setTimeout(function () {
        document.querySelector('button').style.display = 'flex'
        atualizarLives()
      }, 2000);
    }
    createLives()
  </script>
</body>

</html>